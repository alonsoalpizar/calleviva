<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CalleViva - Simulaci√≥n del D√≠a</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Nunito', sans-serif;
        }

        .coral {
            color: #FF6B6B;
        }

        .bg-coral {
            background-color: #FF6B6B;
        }

        .bg-mango {
            background-color: #FFE66D;
        }

        .bg-crema {
            background-color: #FFF8E7;
        }

        .bg-agua {
            background-color: #4ECDC4;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(100px);
                opacity: 0;
            }
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0) rotate(-2deg);
            }

            50% {
                transform: translateY(-5px) rotate(2deg);
            }
        }

        .customer-enter {
            animation: slideIn 0.5s ease forwards;
        }

        .customer-exit {
            animation: slideOut 0.5s ease forwards;
        }

        .money-pop {
            animation: bounce 0.3s ease;
        }

        .truck-idle {
            animation: float 3s ease-in-out infinite;
        }

        .progress-fill {
            transition: width 0.3s ease;
        }

        .stat-update {
            animation: pulse 0.3s ease;
        }

        .event-card {
            animation: slideIn 0.3s ease;
        }

        .speed-btn.active {
            background: #FF6B6B;
            color: white;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-sky-100 via-blue-50 to-cyan-100 min-h-screen">

    <div id="app" class="max-w-5xl mx-auto p-4">

        <!-- Header -->
        <header class="bg-white rounded-2xl shadow-lg p-4 mb-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <span class="text-3xl">üöö</span>
                    <div>
                        <h1 class="font-black text-xl">Calle<span class="coral">Viva</span></h1>
                        <p class="text-sm text-gray-500">D√≠a 7 - Universidad</p>
                    </div>
                </div>

                <!-- Live Stats -->
                <div class="flex gap-6">
                    <div class="text-center">
                        <div class="text-xs text-gray-500 uppercase">Hora</div>
                        <div id="clock" class="text-2xl font-black text-blue-600">6:00</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-500 uppercase">Clientes</div>
                        <div id="customers-count" class="text-2xl font-black text-purple-600">0</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xs text-gray-500 uppercase">Ventas</div>
                        <div id="sales" class="text-2xl font-black text-green-600">‚Ç°0</div>
                    </div>
                </div>

                <!-- Speed Controls -->
                <div class="flex items-center gap-2">
                    <span class="text-sm text-gray-500">Velocidad:</span>
                    <button onclick="setSpeed(1)"
                        class="speed-btn active px-3 py-1 rounded-lg text-sm font-bold bg-gray-200">1x</button>
                    <button onclick="setSpeed(2)"
                        class="speed-btn px-3 py-1 rounded-lg text-sm font-bold bg-gray-200">2x</button>
                    <button onclick="setSpeed(5)"
                        class="speed-btn px-3 py-1 rounded-lg text-sm font-bold bg-gray-200">5x</button>
                </div>
            </div>

            <!-- Time Progress -->
            <div class="mt-4">
                <div class="flex justify-between text-xs text-gray-500 mb-1">
                    <span>6:00 AM</span>
                    <span>12:00 PM</span>
                    <span>6:00 PM</span>
                </div>
                <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                    <div id="time-progress"
                        class="progress-fill h-full bg-gradient-to-r from-amber-400 via-orange-400 to-red-400 rounded-full"
                        style="width: 0%"></div>
                </div>
            </div>
        </header>

        <!-- Main Game Area -->
        <div class="grid grid-cols-12 gap-4">

            <!-- Left: Queue & Weather -->
            <div class="col-span-3 space-y-4">

                <!-- Weather -->
                <div class="bg-white rounded-xl p-4 shadow-lg text-center">
                    <div class="text-4xl mb-2" id="weather-icon">‚òÄÔ∏è</div>
                    <div class="font-bold">Soleado</div>
                    <div class="text-sm text-green-600">+20% clientes</div>
                </div>

                <!-- Queue -->
                <div class="bg-white rounded-xl p-4 shadow-lg">
                    <h3 class="font-bold text-gray-700 mb-3">üö∂ Cola de Espera</h3>
                    <div id="queue" class="space-y-2 min-h-[200px]">
                        <!-- Customers will appear here -->
                        <div class="text-center text-gray-400 py-8">
                            Esperando clientes...
                        </div>
                    </div>
                </div>

            </div>

            <!-- Center: Food Truck & Action -->
            <div class="col-span-6 space-y-4">

                <!-- Food Truck Scene -->
                <div
                    class="bg-gradient-to-b from-sky-200 to-green-200 rounded-xl p-6 shadow-lg min-h-[300px] relative overflow-hidden">

                    <!-- Sun/Weather -->
                    <div class="absolute top-4 right-4 text-5xl" id="scene-weather">‚òÄÔ∏è</div>

                    <!-- Food Truck -->
                    <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2">
                        <div class="truck-idle text-8xl">üöö</div>
                        <div class="text-center mt-2">
                            <span class="bg-white px-3 py-1 rounded-full text-sm font-bold shadow">Mi Food Truck</span>
                        </div>
                    </div>

                    <!-- Current Customer -->
                    <div id="current-customer" class="absolute bottom-8 left-16 text-6xl opacity-0">
                        üë§
                    </div>

                    <!-- Sale Popup -->
                    <div id="sale-popup"
                        class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 opacity-0">
                        <div class="bg-green-500 text-white px-6 py-3 rounded-xl font-black text-2xl shadow-lg">
                            +‚Ç°2,500
                        </div>
                    </div>

                </div>

                <!-- Current Transaction -->
                <div id="transaction-panel" class="bg-white rounded-xl p-4 shadow-lg">
                    <div class="text-center text-gray-400 py-4">
                        <p class="text-lg">Presiona <strong>Iniciar D√≠a</strong> para comenzar</p>
                    </div>
                </div>

                <!-- Control Buttons -->
                <div class="flex gap-3">
                    <button id="start-btn" onclick="startDay()"
                        class="flex-1 py-4 bg-coral text-white rounded-xl font-black text-lg hover:bg-red-400 transition shadow-lg">
                        ‚òÄÔ∏è ¬°Iniciar D√≠a!
                    </button>
                    <button id="pause-btn" onclick="togglePause()"
                        class="hidden py-4 px-6 bg-gray-200 rounded-xl font-bold hover:bg-gray-300 transition">
                        ‚è∏Ô∏è
                    </button>
                </div>

            </div>

            <!-- Right: Inventory & Sales -->
            <div class="col-span-3 space-y-4">

                <!-- Inventory -->
                <div class="bg-white rounded-xl p-4 shadow-lg">
                    <h3 class="font-bold text-gray-700 mb-3">üì¶ Stock Restante</h3>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between">
                            <span>üç≥ Gallo Pinto</span>
                            <span id="stock-pinto" class="font-bold">8</span>
                        </div>
                        <div class="h-2 bg-gray-200 rounded-full">
                            <div id="stock-pinto-bar" class="h-full bg-green-500 rounded-full transition-all"
                                style="width: 100%"></div>
                        </div>

                        <div class="flex items-center justify-between mt-3">
                            <span>ü•ü Empanadas</span>
                            <span id="stock-empanadas" class="font-bold">15</span>
                        </div>
                        <div class="h-2 bg-gray-200 rounded-full">
                            <div id="stock-empanadas-bar" class="h-full bg-green-500 rounded-full transition-all"
                                style="width: 100%"></div>
                        </div>

                        <div class="flex items-center justify-between mt-3">
                            <span>‚òï Agua Dulce</span>
                            <span id="stock-agua" class="font-bold">20</span>
                        </div>
                        <div class="h-2 bg-gray-200 rounded-full">
                            <div id="stock-agua-bar" class="h-full bg-green-500 rounded-full transition-all"
                                style="width: 100%"></div>
                        </div>
                    </div>
                </div>

                <!-- Live Feed -->
                <div class="bg-white rounded-xl p-4 shadow-lg">
                    <h3 class="font-bold text-gray-700 mb-3">üìú Actividad</h3>
                    <div id="activity-feed" class="space-y-2 max-h-[250px] overflow-y-auto text-sm">
                        <div class="text-gray-400 text-center py-4">
                            Sin actividad a√∫n...
                        </div>
                    </div>
                </div>

            </div>

        </div>

        <!-- Event Modal (for Level 3) -->
        <div id="event-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <div class="bg-white rounded-2xl p-6 max-w-md mx-4 event-card">
                <div class="text-center">
                    <div class="text-5xl mb-4" id="event-icon">‚ö†Ô∏è</div>
                    <h2 class="text-xl font-black mb-2" id="event-title">¬°Evento!</h2>
                    <p class="text-gray-600 mb-6" id="event-description">Descripci√≥n del evento</p>
                    <div class="flex gap-3" id="event-buttons">
                        <!-- Dynamic buttons -->
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Game State
        let gameState = {
            running: false,
            paused: false,
            speed: 1,
            currentHour: 6, // 6 AM
            currentMinute: 0,
            totalSales: 0,
            customersServed: 0,
            stock: {
                pinto: 8,
                empanadas: 15,
                agua: 20
            },
            maxStock: {
                pinto: 8,
                empanadas: 15,
                agua: 20
            }
        };

        // Customer Types
        const customerTypes = [
            { emoji: 'üë©‚Äçüéì', name: 'Estudiante', preference: 'empanadas', budget: 'low' },
            { emoji: 'üë®‚Äçüéì', name: 'Estudiante', preference: 'pinto', budget: 'low' },
            { emoji: 'üë®‚Äçüíº', name: 'Oficinista', preference: 'pinto', budget: 'medium' },
            { emoji: 'üë©‚Äçüíº', name: 'Oficinista', preference: 'agua', budget: 'medium' },
            { emoji: 'üë¥', name: 'Jubilado', preference: 'agua', budget: 'low' },
            { emoji: 'üëµ', name: 'Abuelita', preference: 'pinto', budget: 'low' },
            { emoji: 'üßë‚Äçüç≥', name: 'Chef', preference: 'pinto', budget: 'high' },
            { emoji: 'üë∑', name: 'Trabajador', preference: 'empanadas', budget: 'medium' },
        ];

        // Products
        const products = {
            pinto: { name: 'Gallo Pinto', emoji: 'üç≥', price: 2500 },
            empanadas: { name: 'Empanadas', emoji: 'ü•ü', price: 1500 },
            agua: { name: 'Agua Dulce', emoji: '‚òï', price: 1000 }
        };

        // Customer dialogues (simulating AI)
        const dialogues = {
            greeting: [
                "¬°Hola! ¬øQu√© hay de bueno hoy?",
                "Buenos d√≠as, ¬øqu√© me recomienda?",
                "¬°Mmm, huele delicioso!",
                "¬øTodav√≠a tienen gallo pinto?",
                "¬°Por fin los encuentro!"
            ],
            happy: [
                "¬°Muy rico, gracias!",
                "¬°Excelente! Volver√© ma√±ana",
                "¬°Pura vida! üá®üá∑",
                "¬°Justo lo que necesitaba!",
                "¬°Se lo recomendar√© a mis amigos!"
            ],
            sad: [
                "Qu√© l√°stima, no hay...",
                "Bueno, ser√° para otra vez",
                "¬øCu√°ndo tendr√°n m√°s?",
            ]
        };

        // Utility Functions
        function randomItem(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function formatMoney(amount) {
            return '‚Ç°' + amount.toLocaleString();
        }

        function updateClock() {
            const hourStr = gameState.currentHour.toString().padStart(2, '0');
            const minStr = gameState.currentMinute.toString().padStart(2, '0');
            document.getElementById('clock').textContent = `${hourStr}:${minStr}`;

            // Progress bar (6AM to 6PM = 12 hours)
            const totalMinutes = (gameState.currentHour - 6) * 60 + gameState.currentMinute;
            const progress = (totalMinutes / (12 * 60)) * 100;
            document.getElementById('time-progress').style.width = `${progress}%`;
        }

        function updateStats() {
            document.getElementById('sales').textContent = formatMoney(gameState.totalSales);
            document.getElementById('customers-count').textContent = gameState.customersServed;
        }

        function updateStock() {
            for (const [key, value] of Object.entries(gameState.stock)) {
                const percent = (value / gameState.maxStock[key]) * 100;
                document.getElementById(`stock-${key === 'pinto' ? 'pinto' : key}`).textContent = value;
                const bar = document.getElementById(`stock-${key === 'pinto' ? 'pinto' : key}-bar`);
                bar.style.width = `${percent}%`;
                bar.className = `h-full rounded-full transition-all ${percent > 30 ? 'bg-green-500' : percent > 10 ? 'bg-yellow-500' : 'bg-red-500'}`;
            }
        }

        function addActivity(message, type = 'normal') {
            const feed = document.getElementById('activity-feed');
            if (feed.querySelector('.text-gray-400')) {
                feed.innerHTML = '';
            }

            const colors = {
                sale: 'text-green-600',
                customer: 'text-blue-600',
                warning: 'text-amber-600',
                error: 'text-red-600',
                normal: 'text-gray-600'
            };

            const entry = document.createElement('div');
            entry.className = `${colors[type]} py-1 border-b border-gray-100`;
            entry.innerHTML = `<span class="text-gray-400 text-xs">${gameState.currentHour}:${gameState.currentMinute.toString().padStart(2, '0')}</span> ${message}`;
            feed.insertBefore(entry, feed.firstChild);
        }

        function showSalePopup(amount) {
            const popup = document.getElementById('sale-popup');
            popup.querySelector('div').textContent = '+' + formatMoney(amount);
            popup.style.opacity = '1';
            popup.style.transform = 'translate(-50%, -50%) scale(1.2)';

            setTimeout(() => {
                popup.style.opacity = '0';
                popup.style.transform = 'translate(-50%, -50%) scale(1)';
            }, 800);
        }

        function showCustomer(customer) {
            const el = document.getElementById('current-customer');
            el.textContent = customer.emoji;
            el.style.opacity = '1';
            el.className = 'absolute bottom-8 left-16 text-6xl customer-enter';
        }

        function hideCustomer() {
            const el = document.getElementById('current-customer');
            el.className = 'absolute bottom-8 left-16 text-6xl customer-exit';
            setTimeout(() => {
                el.style.opacity = '0';
            }, 500);
        }

        function updateTransactionPanel(content) {
            document.getElementById('transaction-panel').innerHTML = content;
        }

        // Game Loop
        let gameInterval;

        function startDay() {
            if (gameState.running) return;

            gameState.running = true;
            document.getElementById('start-btn').classList.add('hidden');
            document.getElementById('pause-btn').classList.remove('hidden');

            addActivity('üåÖ ¬°El d√≠a comienza!', 'normal');

            gameInterval = setInterval(gameTick, 1000 / gameState.speed);
        }

        function togglePause() {
            gameState.paused = !gameState.paused;
            document.getElementById('pause-btn').textContent = gameState.paused ? '‚ñ∂Ô∏è' : '‚è∏Ô∏è';

            if (gameState.paused) {
                addActivity('‚è∏Ô∏è D√≠a pausado', 'warning');
            } else {
                addActivity('‚ñ∂Ô∏è Continuando...', 'normal');
            }
        }

        function setSpeed(speed) {
            gameState.speed = speed;
            document.querySelectorAll('.speed-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            if (gameState.running) {
                clearInterval(gameInterval);
                gameInterval = setInterval(gameTick, 1000 / gameState.speed);
            }
        }

        function gameTick() {
            if (gameState.paused) return;

            // Advance time (1 tick = 5 minutes)
            gameState.currentMinute += 5;
            if (gameState.currentMinute >= 60) {
                gameState.currentMinute = 0;
                gameState.currentHour++;
            }

            updateClock();

            // End of day
            if (gameState.currentHour >= 18) {
                endDay();
                return;
            }

            // Random customer arrival
            if (Math.random() < getCustomerChance()) {
                spawnCustomer();
            }
        }

        function getCustomerChance() {
            // Higher chance during lunch hours
            const hour = gameState.currentHour;
            if (hour >= 11 && hour <= 14) return 0.7; // Lunch rush
            if (hour >= 7 && hour <= 9) return 0.5;   // Breakfast
            if (hour >= 16 && hour <= 17) return 0.4; // Afternoon
            return 0.25; // Normal
        }

        async function spawnCustomer() {
            const customer = randomItem(customerTypes);

            showCustomer(customer);
            addActivity(`${customer.emoji} ${customer.name} lleg√≥`, 'customer');

            // Show greeting
            updateTransactionPanel(`
        <div class="flex items-start gap-4">
          <div class="text-5xl">${customer.emoji}</div>
          <div class="flex-1">
            <div class="font-bold">${customer.name}</div>
            <div class="bg-gray-100 rounded-xl p-3 mt-2 italic text-gray-600">
              "${randomItem(dialogues.greeting)}"
            </div>
          </div>
        </div>
      `);

            await sleep(1500 / gameState.speed);

            // Try to buy preferred product
            const pref = customer.preference;
            if (gameState.stock[pref] > 0) {
                // Successful sale
                gameState.stock[pref]--;
                const product = products[pref];
                gameState.totalSales += product.price;
                gameState.customersServed++;

                updateStock();
                updateStats();
                showSalePopup(product.price);

                addActivity(`${product.emoji} Vendido ${product.name} ${formatMoney(product.price)}`, 'sale');

                updateTransactionPanel(`
          <div class="flex items-start gap-4">
            <div class="text-5xl">${customer.emoji}</div>
            <div class="flex-1">
              <div class="font-bold">${customer.name}</div>
              <div class="text-sm text-gray-500">Compr√≥: ${product.emoji} ${product.name}</div>
              <div class="bg-green-100 rounded-xl p-3 mt-2 italic text-green-700">
                "${randomItem(dialogues.happy)}"
              </div>
              <div class="mt-2 text-xl font-black text-green-600">+${formatMoney(product.price)}</div>
            </div>
          </div>
        `);

            } else {
                // Out of stock
                addActivity(`‚ùå Sin stock de ${products[pref].name}`, 'error');

                updateTransactionPanel(`
          <div class="flex items-start gap-4">
            <div class="text-5xl">${customer.emoji}</div>
            <div class="flex-1">
              <div class="font-bold">${customer.name}</div>
              <div class="text-sm text-red-500">Quer√≠a: ${products[pref].emoji} ${products[pref].name}</div>
              <div class="bg-red-100 rounded-xl p-3 mt-2 italic text-red-700">
                "${randomItem(dialogues.sad)}"
              </div>
              <div class="mt-2 text-red-500 font-bold">Cliente perdido üò¢</div>
            </div>
          </div>
        `);
            }

            await sleep(2000 / gameState.speed);
            hideCustomer();

            await sleep(500 / gameState.speed);
            updateTransactionPanel(`
        <div class="text-center text-gray-400 py-4">
          Esperando siguiente cliente...
        </div>
      `);
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function endDay() {
            clearInterval(gameInterval);
            gameState.running = false;

            addActivity('üåÖ ¬°Fin del d√≠a!', 'warning');

            // Show results
            updateTransactionPanel(`
        <div class="text-center py-6">
          <div class="text-5xl mb-4">üéâ</div>
          <h2 class="text-2xl font-black mb-2">¬°D√≠a Terminado!</h2>
          <div class="grid grid-cols-2 gap-4 max-w-sm mx-auto mt-4">
            <div class="bg-green-100 rounded-xl p-3">
              <div class="text-2xl font-black text-green-600">${formatMoney(gameState.totalSales)}</div>
              <div class="text-sm text-gray-600">Ventas Totales</div>
            </div>
            <div class="bg-blue-100 rounded-xl p-3">
              <div class="text-2xl font-black text-blue-600">${gameState.customersServed}</div>
              <div class="text-sm text-gray-600">Clientes</div>
            </div>
          </div>
          <button onclick="location.reload()" class="mt-6 px-6 py-3 bg-coral text-white rounded-xl font-bold hover:bg-red-400">
            Ver Resultados Completos ‚Üí
          </button>
        </div>
      `);
        }

        // Initialize
        updateClock();
        updateStats();
        updateStock();
    </script>

</body>

</html>